/*
 * Copyright (C) 2015-2019 Variscite Ltd. - https://www.variscite.com
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 2 as
 * published by the Free Software Foundation.
 */

/ {
	backlight {
		compatible = "pwm-backlight";
		pwms = <&pwm1 0 20000>;
		brightness-levels = <0 4 8 16 32 64 128 255>;
		default-brightness-level = <6>;
		status = "okay";
	};

	chosen {
		stdout-path = &uart1;
	};
};

&fec1 {
	pinctrl-0 = <&pinctrl_enet1>, <&pinctrl_enet1_gpio>;
	/delete-node/ mdio;
};

&fec2 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_enet2>, <&pinctrl_enet2_gpio>, <&pinctrl_enet2_mdio>;
	phy-mode = "rmii";
	phy-handle = <&ethphy1>;
	phy-reset-gpios=<&gpio1 10 GPIO_ACTIVE_LOW>;
	phy-reset-duration=<100>;
	status = "okay";

	mdio {
		#address-cells = <1>;
		#size-cells = <0>;

		ethphy0: ethernet-phy@1 {
			compatible = "ethernet-phy-ieee802.3-c22";
			micrel,rmii-reference-clock-select-25-mhz;
			micrel,led-mode = <1>;
			clocks = <&rmii_ref_clk>;
			clock-names = "rmii-ref";
			reg = <1>;
		};

		ethphy1: ethernet-phy@3 {
			compatible = "ethernet-phy-ieee802.3-c22";
			micrel,rmii-reference-clock-select-25-mhz;
			micrel,led-mode = <1>;
			clocks = <&rmii_ref_clk>;
			clock-names = "rmii-ref";
			reg = <3>;
		};
	};
};

&i2c2 {
	/* DS1337 RTC module */
	rtc@68 {
		compatible = "dallas,ds1337";
		reg = <0x68>;
		pinctrl-names = "default";
		pinctrl-0 = <&pinctrl_rtc>;
		interrupt-parent = <&gpio5>;
		interrupts = <7 IRQ_TYPE_EDGE_FALLING>;
	};
};

&iomuxc {
	pinctrl_hog_hog_10: hoggrp-10 {
		fsl,pins = <
			/* gpios */
			MX6UL_PAD_SNVS_TAMPER5__GPIO5_IO05	0x5800A0 /* SCC_AB */
			MX6UL_PAD_SNVS_TAMPER3__GPIO5_IO03	0x5800A0 /* SCC_DC */
			MX6UL_PAD_LCD_DATA02__GPIO3_IO07	0x5800A0 /* SCC_CE */
			MX6UL_PAD_LCD_DATA16__GPIO3_IO21	0x5800A0 /* SCC_D4 */
			MX6UL_PAD_LCD_DATA18__GPIO3_IO23	0x5800A0 /* SCC_D6 */
			MX6UL_PAD_LCD_DATA17__GPIO3_IO22	0x5800A0 /* SCC_D5 */
			MX6UL_PAD_LCD_DATA14__GPIO3_IO19	0x5800A0 /* SCC_D2 */
			MX6UL_PAD_LCD_DATA12__GPIO3_IO17	0x5800A0 /* SCC_D1 */
			MX6UL_PAD_LCD_DATA08__GPIO3_IO13	0x5800A0 /* SCC_D0 */
			MX6UL_PAD_LCD_DATA04__GPIO3_IO09	0x5800A0 /* GPS_RESET */
			MX6UL_PAD_LCD_DATA19__GPIO3_IO24	0x5800A0 /* SCC_D7 */
			MX6UL_PAD_LCD_DATA15__GPIO3_IO20	0x5800A0 /* SCC_D3 */
			MX6UL_PAD_LCD_DATA01__GPIO3_IO06	0x5800A0 /* SCC_RD */
			MX6UL_PAD_LCD_DATA03__GPIO3_IO08	0x5800A0 /* SCC_WR */
			MX6UL_PAD_LCD_DATA00__GPIO3_IO05	0x5800A0 /* SCC_INTACK */
			MX6UL_PAD_LCD_DATA10__GPIO3_IO15	0x5800A0 /* SCC_DIR */
			MX6UL_PAD_LCD_RESET__GPIO3_IO04		0x5800A0 /* SCC_IEO */
			MX6UL_PAD_CSI_PIXCLK__GPIO4_IO18	0x5800A0 /* HOST_USB_PWR_SW */
			MX6UL_PAD_CSI_MCLK__GPIO4_IO17		0x5800A0 /* HOST_USB_OVCR */
			MX6UL_PAD_GPIO1_IO05__GPIO1_IO05	0x5800A0 /* SP1_DCD */
			MX6UL_PAD_SNVS_TAMPER7__GPIO5_IO07	0x5800A0 /* RTC_IRQ */
			MX6UL_PAD_SNVS_TAMPER8__GPIO5_IO08	0x5800A0 /* HOST_LINESYNC */
			MX6UL_PAD_SNVS_TAMPER9__GPIO5_IO09	0x5800A0 /* PCA9555_INT */
			MX6UL_PAD_UART4_TX_DATA__GPIO1_IO28	0x5800A0 /* SCC_INT */
			MX6UL_PAD_GPIO1_IO01__GPIO1_IO01	0x5800A0 /* ENGX_USB_OVRC */
			MX6UL_PAD_GPIO1_IO02__GPIO1_IO02	0x5800A0 /* SPI_DUART_RESET */
			MX6UL_PAD_GPIO1_IO04__GPIO1_IO04	0x5800A0 /* ENGX_USB_VBUSCTRL */
			MX6UL_PAD_GPIO1_IO00__GPIO1_IO00	0x5800A0 /* ADC0.0 */
			MX6UL_PAD_SNVS_TAMPER1__GPIO5_IO01	0x5800A0 /* SP2_DCD */
			MX6UL_PAD_LCD_VSYNC__GPIO3_IO03		0x5800A0 /* UART4 DCE RTS */
			MX6UL_PAD_LCD_HSYNC__GPIO3_IO02		0x5800A0 /* UART4 DCE CTS */
			MX6UL_PAD_CSI_DATA03__GPIO4_IO24	0x5800A0 /* UART5 DCE CTS */
			MX6UL_PAD_CSI_DATA02__GPIO4_IO23	0x5800A0 /* UART5 DCE RTS */
		>;
	};

	pinctrl_enet2: enet2grp {
		fsl,pins = <
			MX6UL_PAD_ENET2_RX_EN__ENET2_RX_EN	0x1b0b0
			MX6UL_PAD_ENET2_RX_ER__ENET2_RX_ER	0x1b0b0
			MX6UL_PAD_ENET2_RX_DATA0__ENET2_RDATA00	0x1b0b0
			MX6UL_PAD_ENET2_RX_DATA1__ENET2_RDATA01	0x1b0b0
			MX6UL_PAD_ENET2_TX_EN__ENET2_TX_EN	0x1b0b0
			MX6UL_PAD_ENET2_TX_DATA0__ENET2_TDATA00	0x1b0b0
			MX6UL_PAD_ENET2_TX_DATA1__ENET2_TDATA01	0x1b0b0
			MX6UL_PAD_ENET2_TX_CLK__ENET2_REF_CLK2	0x4001b031
		>;
	};

	pinctrl_enet2_gpio: enet2_gpiogrp {
		fsl,pins = <
			MX6UL_PAD_JTAG_MOD__GPIO1_IO10		0x1b0b0 /* fec2 reset */
		>;
	};

	pinctrl_enet2_mdio: enet2_mdiogrp {
		fsl,pins = <
			MX6UL_PAD_GPIO1_IO06__ENET2_MDIO	0x1b0b0
			MX6UL_PAD_GPIO1_IO07__ENET2_MDC		0x1b0b0
		>;
	};

	pinctrl_uart1: uart1grp {
		fsl,pins = <
			MX6UL_PAD_UART1_TX_DATA__UART1_DCE_TX   0x1b0b1
			MX6UL_PAD_UART1_RX_DATA__UART1_DCE_RX   0x1b0b1
		>;
	};

	pinctrl_uart3: uart3grp {
		fsl,pins = <
			MX6UL_PAD_UART3_TX_DATA__UART3_DCE_TX	0x1b0b1
			MX6UL_PAD_UART3_RX_DATA__UART3_DCE_RX	0x1b0b1
			MX6UL_PAD_UART3_CTS_B__UART3_DCE_CTS	0x1b0b1
			MX6UL_PAD_UART3_RTS_B__UART3_DCE_RTS	0x1b0b1
		>;
	};

	pinctrl_uart4: uart4grp {
		fsl,pins = <
			MX6UL_PAD_LCD_CLK__UART4_DCE_TX		0x1b0b1
			MX6UL_PAD_LCD_ENABLE__UART4_DCE_RX	0x1b0b1
		>;
	};

	pinctrl_uart5: uart5grp {
		fsl,pins = <
			MX6UL_PAD_CSI_DATA00__UART5_DCE_TX	0x1b0b1
			MX6UL_PAD_CSI_DATA01__UART5_DCE_RX	0x1b0b1
		>;
	};

	pinctrl_wdog: wdoggrp {
		fsl,pins = <
			MX6UL_PAD_GPIO1_IO08__WDOG1_WDOG_B	0x78b0
		>;
	};

	pinctrl_ecspi1: ecspi1grp {
		fsl,pins = <
			MX6UL_PAD_LCD_DATA23__ECSPI1_MISO	0x100b1
			MX6UL_PAD_LCD_DATA22__ECSPI1_MOSI	0x100b1
			MX6UL_PAD_LCD_DATA20__ECSPI1_SCLK	0x100b1
		>;
	};

	pinctrl_ecspi1_duart1_cs: ecspi1_cs0 {
		fsl,pins = <
			MX6UL_PAD_LCD_DATA13__GPIO3_IO18	0x100b1 /* SPI_DUART1_CS */
		>;
	};

	pinctrl_ecspi1_nvsram_cs: ecspi1_cs2 {
		fsl,pins = <
			MX6UL_PAD_LCD_DATA11__GPIO3_IO16	0x100b1 /* NVSRAM_CS */
		>;
	};

	pinctrl_ecspi1_ss1_cs: ecspi1_cs3 {
		fsl,pins = <
			MX6UL_PAD_LCD_DATA05__GPIO3_IO10	0x100b1 /* ECSPI1_SS1 */
		>;
	};
};

&snvs_rtc {
	status = "disabled";
};

/* Console UART */
&uart1 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_uart1>;
	status = "okay";
};

/* ttymxc2 UART */
&uart3 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_uart3>;
	fsl,uart-has-rtscts;
	status = "okay";
};

/* ttymxc3 UART */
&uart4 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_uart4>;
	status = "okay";
};

/* ttymxc4 UART */
&uart5 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_uart5>;
	status = "okay";
};

&usbotg1 {
	dr_mode = "host";
	status = "okay";
};

&usbotg2 {
	dr_mode = "host";
	status = "okay";
};

&wdog1 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_wdog>;
	fsl,ext-reset-output;
};

&ecspi1 {
	fsl,spi-num-chipselects = <3>;
	cs-gpios =	<&gpio3 18 1>,
			<&gpio3 16 1>,
			<&gpio3 10 1>;
	pinctrl-names = "default";
	pinctrl-0 = <
		&pinctrl_ecspi1
		&pinctrl_ecspi1_duart1_cs
		&pinctrl_ecspi1_nvsram_cs
		&pinctrl_ecspi1_ss1_cs
		>;
	status = "okay";

	SPI_DUART1: sc16is752@0 {
		compatible = "nxp,sc16is752";
		reg = <0>;
		clocks = <&sc16is752_clk0>;
		interrupt-parent = <&gpio1>;
		interrupts = <9 IRQ_TYPE_EDGE_FALLING>;
		spi-max-frequency = <4000000>;
		sc16is752_clk0: sc16is752_0_clk {
			compatible = "fixed-clock";
			#clock-cells = <0>;
			clock-frequency = <11059200>;
		};
	};

	NVSRSM: spi_sram@1 {
		#address-cells = <1>;
		#size-cells = <1>;
		compatible = "microchip,mchp23lcv1024";
		reg = <1>;
		spi-max-frequency = <6000000>;
		status = "okay";
	};

	ECSPI1_SS1: spidev@1 {
		compatible = "spidev";
		spi-max-frequency = <6000000>;
		reg = <2>;
		interrupt-parent = <&gpio1>;
		interrupts = <29 IRQ_TYPE_EDGE_FALLING>;
		status = "disable";
	};
};
